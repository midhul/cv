---
layout: index
---

## Web based CAPTCHA image recognizer

December 2014    _(Partially complete)_   [[Download Source .zip]]({{ site.url }}downloads/source.zip)

The aim of this work was to build a web browser based extension which could recognize the text in CAPTCHA images generated by a particular generator. Many well developed OCR engines (for example Tesseract) are available, but none of these are web based making it difficult to build a browser extension which makes use of them. I attempted to write a CAPTCHA recognizer in pure javascript, which I was able to complete only partially. Details about my plan and results obtained can be found below. 

### Initial CAPTCHA image
The following are some images of raw captcha which I was trying to recognize:

![Initial CAPTCHA image]({{ site.url }}assets/img10.png) ![Initial CAPTCHA image]({{ site.url }}assets/img8.png) ![Initial CAPTCHA image]({{ site.url }}assets/img9.png)

### Plan of action
After doing a bit of research about how captcha's are generally cracked, I figured the following plan of action:

* Noise removal (removing the un-necessary stuff the majority of the image is covered with)
* Character Segmentation (design an algorithm to properly separate individual characters)
* Character recognition (select features from the charcters and feed them into a neural network)

### Noise removal
Noise removal was quite daunting in this case, as it is difficult to find objective differentiation between the characters and noise. I tried implementing several linear image filters, but they were of very little use. I implemented a flood-fill style algorithm followed by some morphological operators to eliminiate a major part of the noise.
#### Flood-fill style algorithm
After greyscaling and thresholding the image, I observed that most of the noise patches were connected. So I implemented a flood-fill style algorithm which traverses each connected component in the image pixel-wise and removes components with less number of pixels. (lower than a particular treshold). The result looked something like this:  
![After applying flood fill]({{ site.url }}assets/floodfill.png)
#### Morphological operators
To remove the residual noise, I had to apply a few morphological operators (opening) using a 3x3 L shaped structuring element, resulting in the following:  
![After opening]({{ site.url }}assets/morph.png)


### Character Segmentation
This part turned out to be challenging because all characters were not of constant width and sometimes they touched each other. I tried 2 different techinques for the same:
#### K-means clustering
I applied the _k-means clustering algorithm_ giving the approximate expected centres of the characters as the initial centroids. It worked well on some cases but failed in others:
###### Success:
![success of k-means clustering]({{ site.url }}assets/kmeans0.png)
![success of k-means clustering]({{ site.url }}assets/kmeans1.png)
###### Failure:
![failure of k-means clustering]({{ site.url }}assets/kmeans2.png)

#### Whitespace segmentation
Here I used the inherent whitespace present between most characters to separate them. This fails when 2 charcters touch each other or are very close.
###### Success:
![success of whitespace]({{ site.url }}assets/whitespace.png)
![success of whitespace]({{ site.url }}assets/whitespace1.png)
###### Failure:
![failure of whitespace]({{ site.url }}assets/whitespacef.png)

### Character recognition _(Incomplete)_
I was unable to implement algorithms for this part and had to leave the work incomplete. The basic idea was to extract features from the segmented characters and input them into a feed-forward neural network.  
The open source javascript library [Brain.js](https://github.com/harthur/brain) makes it very easy to implement Artificial Neural Networks (ANNs) in javascript. The following are the set of features which I planned to experiment with:

* Zoning (splitting the image's pixels into zones and examining their intensities)
* Intersection of the pixels with randomly chosen line segments
* [Hu's moments](http://en.wikipedia.org/wiki/Image_moment) of the image (invariant to translation)

### Conclusions
The most challenging part of recognizing CAPTCHA's is that of character segmentation in general. There are many well known machine learning techniques which can be applied to effectively recognize characters with high accuracy. (ANNs, Support vector machines etc..)
